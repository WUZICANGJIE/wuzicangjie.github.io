<!DOCTYPE html>
<html lang="<%= lang %>">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; img-src 'self' https://ui-avatars.com data:; script-src 'self'; style-src 'self'; connect-src 'self'; font-src 'self'; object-src 'none'; base-uri 'self'; form-action 'self'; require-trusted-types-for 'script';">
    <meta name="referrer" content="strict-origin-when-cross-origin">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- SEO: Hreflang Tags -->
    <% languages.forEach(l => { %>
    <link rel="alternate" hreflang="<%= l %>" href="<%= site.siteUrl %><%= l === 'en' ? '' : l + '/' %>" />
    <% }); %>
    <link rel="alternate" hreflang="x-default" href="<%= site.siteUrl %>" />

    <!-- Primary Meta Tags -->
    <title><%= title %></title>
    <meta name="title" content="<%= title %>" />
    <meta name="description" content="<%= description %>" />
    <meta name="keywords" content="Shaohan Sun, å­™å°‘ç€š, å­«å°‘ç€š, ç„¡å­—å€‰é ¡, æ— å­—ä»“é¢‰, wuzicangjie, mujisoketsu, ã‚½ãƒ³ã‚·ãƒ§ã‚¦ãƒãƒ³, Econ, Homelab" />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content="<%= url %>" />
    <meta property="og:title" content="<%= title %>" />
    <meta property="og:description" content="<%= description %>" />
    <meta property="og:image" content="<%= site.siteUrl %>assets/images/og-image.webp?v=<%= version %>" />

    <!-- X (Twitter) -->
    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:url" content="<%= url %>" />
    <meta property="twitter:title" content="<%= title %>" />
    <meta property="twitter:description" content="<%= description %>" />
    <meta property="twitter:image" content="<%= site.siteUrl %>assets/images/og-image.webp?v=<%= version %>" />

    <link rel="icon" type="image/png" href="<%= site.baseUrl %>favicon-96x96.png?v=<%= version %>" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="<%= site.baseUrl %>favicon.svg?v=<%= version %>" sizes="any" />
    <link rel="shortcut icon" href="<%= site.baseUrl %>favicon.ico?v=<%= version %>" />
    <link rel="apple-touch-icon" sizes="180x180" href="<%= site.baseUrl %>apple-touch-icon.png?v=<%= version %>" />
    <meta name="apple-mobile-web-app-title" content="Shaohan" />
    <link rel="manifest" href="<%= site.baseUrl %>site.webmanifest" />

    <!-- Preload CSS for Performance -->
    <link rel="preload" href="<%= site.baseUrl %>assets/css/style.css?v=<%= version %>" as="style">

    <!-- Import Tailwind CSS -->
    <link rel="stylesheet" href="<%= site.baseUrl %>assets/css/style.css?v=<%= version %>">
</head>
<body class="bg-gray-50 text-gray-800 dark:bg-zinc-900 dark:text-gray-200 min-h-screen min-w-[320px] flex flex-col justify-center items-center p-4 font-sans transition-colors duration-300">

    <main class="w-full max-w-md mx-auto">
        
        <div class="glass-card relative rounded-3xl shadow-xl border border-white/20 dark:border-white/10 p-8 text-center">
            
            <!-- Language Switcher (Dropdown) -->
            <div class="absolute top-4 right-4 inline-block text-left z-50">
                <button id="lang-menu-btn" aria-label="Select Language" aria-haspopup="true" aria-expanded="false" aria-controls="lang-menu" class="p-2 rounded-full hover:bg-gray-100 dark:hover:bg-white/10 transition-colors">
                    <img src="<%= site.baseUrl %>assets/icons/language.svg" width="24" height="24" class="w-6 h-6 opacity-60 dark:invert" alt="" aria-hidden="true" fetchpriority="high">
                </button>
                
                <!-- Dropdown Menu -->
                <div id="lang-menu" role="menu" aria-orientation="vertical" aria-labelledby="lang-menu-btn" class="hidden absolute right-0 mt-2 w-32 rounded-xl bg-white dark:bg-zinc-800 shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none overflow-hidden transform origin-top-right transition-all duration-200">
                    <div class="py-1" role="none">
                        <a href="<%= site.baseUrl %>zh/" role="menuitem" class="block w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-zinc-700 transition-colors flex items-center gap-2 <%= lang === 'zh' ? 'bg-gray-50 dark:bg-zinc-700/50 font-bold' : '' %>">
                            <span class="w-4 text-center">ðŸ‡¨ðŸ‡³</span> ä¸­æ–‡
                        </a>
                        <a href="<%= site.baseUrl %>" role="menuitem" class="block w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-zinc-700 transition-colors flex items-center gap-2 <%= lang === 'en' ? 'bg-gray-50 dark:bg-zinc-700/50 font-bold' : '' %>">
                            <span class="w-4 text-center">ðŸ‡ºðŸ‡¸</span> English
                        </a>
                        <a href="<%= site.baseUrl %>ja/" role="menuitem" class="block w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-zinc-700 transition-colors flex items-center gap-2 <%= lang === 'ja' ? 'bg-gray-50 dark:bg-zinc-700/50 font-bold' : '' %>">
                            <span class="w-4 text-center">ðŸ‡¯ðŸ‡µ</span> æ—¥æœ¬èªž
                        </a>
                    </div>
                </div>
            </div>

            <!-- Avatar -->
            <div class="relative mb-6 inline-block group animate-fade-in">
                <div class="absolute -inset-1 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full blur opacity-25 group-hover:opacity-50 transition duration-500"></div>
                <img 
                    id="avatar-img"
                    src="<%= site.baseUrl %>assets/images/avatar.webp"  
                    alt="<%= name %>" 
                    width="112"
                    height="112"
                    class="relative w-28 h-28 rounded-full border-4 border-white dark:border-zinc-800 shadow-lg object-cover mx-auto transform transition duration-500 hover:scale-105 motion-reduce:transform-none"
                >
            </div>

            <!-- Title and Bio -->
            <div class="animate-fade-in [animation-delay:100ms]">
                <h1 id="profile-name" class="text-2xl font-bold mb-2 tracking-tight transition-opacity duration-200"><%= name %></h1>
                <p id="profile-bio" class="text-gray-500 dark:text-gray-400 text-sm mb-6 leading-relaxed transition-opacity duration-200">
                    <%- bio %>
                </p>
            </div>

            <!-- Add Contact Button -->
            <a id="contact-btn" href="<%= vcfLink %>" download class="mb-8 w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-4 rounded-xl shadow-lg shadow-blue-500/30 transition-all duration-300 transform hover:-translate-y-0.5 motion-reduce:transform-none flex items-center justify-center gap-2 animate-fade-in [animation-delay:200ms]">
                <img id="contact-icon" src="<%= site.baseUrl %>assets/icons/contact.svg" width="20" height="20" class="w-5 h-5 brightness-0 invert transition-opacity duration-200" alt="Contact">
                <span id="contact-text" class="transition-opacity duration-200"><%= saveContact %></span>
            </a>

            <!-- Social Icon Matrix (3-column grid) -->
            <div class="grid grid-cols-3 gap-4 animate-fade-in [animation-delay:300ms]">
                <% socialLinks.forEach(function(link) { %>
                <a href="<%= link.url %>" <% if (!link.url.startsWith('mailto:')) { %>target="_blank" rel="noopener noreferrer"<% } %> class="flex flex-col items-center justify-center p-3 rounded-xl text-gray-600 dark:text-gray-400 transition-colors <%= link.bgClass %> <%= link.colorClass %>">
                    <div class="social-icon opacity-70 <%= link.iconClass %>"></div>
                    <span class="text-xs"><%= link.name %></span>
                </a>
                <% }); %>
            </div>

        </div>
        
        <footer class="mt-8 text-center text-xs text-gray-600 dark:text-gray-400">
            <p id="footer-text">&copy; <%= year %> wuzicangjie.</p>
        </footer>

    </main>

    <script src="<%= site.baseUrl %>assets/js/main.js?v=<%= version %>" defer></script>
</body>
</html>