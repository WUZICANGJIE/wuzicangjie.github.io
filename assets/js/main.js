window.trustedTypes&&window.trustedTypes.createPolicy&&window.trustedTypes.createPolicy("default",{createHTML:t=>t,createScript:t=>t}),document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("avatar-img");t&&t.addEventListener("error",function(){this.src="https://ui-avatars.com/api/?name=Wu+Zi&background=random"});const e=document.getElementById("lang-menu-btn"),n=document.getElementById("lang-menu");if(e&&n){const t={en:"",zh:"zh/",ja:"ja/"},o=Object.fromEntries(Object.entries(t).map(([t,e])=>[e,t])),i=t=>{const o=n.classList.contains("hidden");void 0===t&&(t=o),t?(n.classList.remove("hidden"),e.setAttribute("aria-expanded","true")):(n.classList.add("hidden"),e.setAttribute("aria-expanded","false"))};e.addEventListener("click",t=>{t.stopPropagation(),i()}),document.addEventListener("click",t=>{n.contains(t.target)||e.contains(t.target)||i(!1)}),document.addEventListener("keydown",t=>{"Escape"!==t.key||n.classList.contains("hidden")||(i(!1),e.focus())});const a=n.querySelectorAll("a"),c={name:new Map,property:new Map},r=(t,e)=>{e.forEach(e=>{const n=document.querySelector(`meta[${t}="${e}"]`);n&&c[t].set(e,n)})};r("name",["title","description"]),r("property",["og:title","og:description","twitter:title","twitter:description","og:url","twitter:url"]);const d={profileName:document.getElementById("profile-name"),profileBio:document.getElementById("profile-bio"),contactBtn:document.getElementById("contact-btn"),contactText:document.getElementById("contact-text"),contactIcon:document.getElementById("contact-icon")},s=d.profileName?.parentElement,l=(t,e,n)=>{const o=c[t].get(e);o&&(o.content=n)},p=(t,e)=>{Object.entries(e).forEach(([e,n])=>l(t,e,n))},m=(t,e)=>{t&&(t.innerText=e)},u=(t,e)=>{t&&(t.innerHTML=e)},w=t=>{t&&(t.classList.remove("animate-fade-in"),t.offsetWidth,t.classList.add("animate-fade-in"))},f=(t=window.location.pathname)=>{const e=t.startsWith("http")?t.replace(/^https?:\/\/[^/]+/,""):t,[,n=""]=e.replace(/^\/+/,"/").split("/");return o[n?`${n}/`:""]??"en"},g=t=>{if(t?.dataset?.lang)return t.dataset.lang;const e=t?.getAttribute("href")||window.location.pathname;return f(e)};let E=null;const h=e=>{if(!e||e===E)return;const n=window.I18N&&window.I18N[e];if(n){if(document.documentElement.lang=e,document.title=n.title,p("name",{title:n.title,description:n.description}),p("property",{"og:title":n.title,"og:description":n.description,"twitter:title":n.title,"twitter:description":n.description}),window.SITE_CONFIG){const n=`${window.SITE_CONFIG.siteUrl}${t[e]||""}`;p("property",{"og:url":n,"twitter:url":n})}m(d.profileName,n.name),u(d.profileBio,n.bio),m(d.contactText,n.saveContact),d.contactBtn&&window.SITE_CONFIG&&(d.contactBtn.href=`${window.SITE_CONFIG.baseUrl}${e}.vcf`),s&&w(s),w(d.contactText),w(d.contactIcon),a.forEach(t=>{const n=g(t)===e?"add":"remove";t.classList[n]("bg-gray-50","dark:bg-zinc-700/50","font-bold")}),E=e}};if(window.I18N){a.forEach(t=>{t.addEventListener("click",e=>{e.preventDefault();const n=t.getAttribute("href"),o=g(t);h(o),window.history.pushState({lang:o},"",n),i(!1)})}),window.addEventListener("popstate",()=>{const t=f(window.location.pathname);h(t)});const t=f();h(t)}}});