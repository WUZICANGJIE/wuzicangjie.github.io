window.trustedTypes&&window.trustedTypes.createPolicy&&window.trustedTypes.createPolicy("default",{createHTML:t=>t,createScript:t=>t}),document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("avatar-img");t&&t.addEventListener("error",function(){this.src="https://ui-avatars.com/api/?name=Wu+Zi&background=random"});const e=document.getElementById("lang-menu-btn"),n=document.getElementById("lang-menu");if(e&&n){const t={en:"",zh:"zh/",ja:"ja/"},o=Object.fromEntries(Object.entries(t).map(([t,e])=>[e,t])),i=t=>{const o=n.classList.contains("hidden");void 0===t&&(t=o),t?(n.classList.remove("hidden"),e.setAttribute("aria-expanded","true")):(n.classList.add("hidden"),e.setAttribute("aria-expanded","false"))};e.addEventListener("click",t=>{t.stopPropagation(),i()}),document.addEventListener("click",t=>{n.contains(t.target)||e.contains(t.target)||i(!1)}),document.addEventListener("keydown",t=>{"Escape"!==t.key||n.classList.contains("hidden")||(i(!1),e.focus())});const a=(t=window.location.pathname)=>{const e=t.startsWith("http")?t.replace(/^https?:\/\/[^/]+/,""):t,[,n=""]=e.replace(/^\/+/,"/").split("/");return o[n?`${n}/`:""]??"en"},c=t=>{if(t?.dataset?.lang)return t.dataset.lang;const e=t?.getAttribute("href")||window.location.pathname;return a(e)},r=n.querySelectorAll("a"),d=new Map(Array.from(r,t=>[t,c(t)])),s={name:new Map,property:new Map},l=(t,e)=>{e.forEach(e=>{const n=document.querySelector(`meta[${t}="${e}"]`);n&&s[t].set(e,n)})};l("name",["title","description"]),l("property",["og:title","og:description","twitter:title","twitter:description","og:url","twitter:url"]);const m={profileName:document.getElementById("profile-name"),profileBio:document.getElementById("profile-bio"),contactBtn:document.getElementById("contact-btn"),contactText:document.getElementById("contact-text"),contactIcon:document.getElementById("contact-icon")},p=m.profileName?.parentElement,u=Array.from(document.querySelectorAll("[data-i18n]")).map(t=>({element:t,key:t.dataset.i18n,type:t.dataset.i18nType||"text"})),w=(t,e,n)=>{const o=s[t].get(e);o&&(o.content=n)},f=(t,e)=>{Object.entries(e).forEach(([e,n])=>w(t,e,n))},g=t=>{t&&(t.classList.remove("animate-fade-in"),t.offsetWidth,t.classList.add("animate-fade-in"))},y=t=>{u.forEach(({element:e,key:n,type:o})=>{const i=t?.[n];void 0!==i&&("html"===o?e.innerHTML=i:e.innerText=i)})};let E=null;const h=e=>{if(!e||e===E)return;const n=window.I18N&&window.I18N[e];if(n){if(document.documentElement.lang=e,document.title=n.title,f("name",{title:n.title,description:n.description}),f("property",{"og:title":n.title,"og:description":n.description,"twitter:title":n.title,"twitter:description":n.description}),window.SITE_CONFIG){const n=`${window.SITE_CONFIG.siteUrl}${t[e]||""}`;f("property",{"og:url":n,"twitter:url":n})}y(n),m.contactBtn&&window.SITE_CONFIG&&(m.contactBtn.href=`${window.SITE_CONFIG.baseUrl}${e}.vcf`),p&&g(p),g(m.contactText),g(m.contactIcon),r.forEach(t=>{const n=d.get(t)===e?"add":"remove";t.classList[n]("bg-gray-50","dark:bg-zinc-700/50","font-bold")}),E=e}};if(window.I18N){r.forEach(t=>{const e=d.get(t);t.addEventListener("click",n=>{n.preventDefault();const o=t.getAttribute("href");h(e),window.history.pushState({lang:e},"",o),i(!1)})}),window.addEventListener("popstate",()=>{const t=a(window.location.pathname);h(t)});const t=a();h(t)}}});